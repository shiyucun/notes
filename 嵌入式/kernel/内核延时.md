
# 内核延时

- [内核延时](#内核延时)
  - [延时分类](#延时分类)
  - [忙延时的方法](#忙延时的方法)
  - [休眠延时的方法](#休眠延时的方法)

"休眠"：适用于进程，进程会将CPU资源释放给别的任务使用。

"当前进程"：正在获取CPU资源的那个进程。

## 延时分类

忙延时：CPU原地空转，适合时间较短的延时。

休眠延时：当前进程释放CPU资源，涉及进程切换(需要开销)。

## 忙延时的方法

```c
ndelay(纳秒数);  // 纳秒级延时
udelay(微秒数);  // 微秒级延时
mdelay(毫秒数);  // 毫秒级延时
// 如果延时时间超过10ms，建议使用休眠延时
```

## 休眠延时的方法

```c
msleep(毫秒数);  // 毫秒级延时
ssleep(秒数);
schedule();     // 永久休眠，接收到信号或者驱动主动唤醒
schedule_timeout(5*HZ);  // 休眠5秒
```
